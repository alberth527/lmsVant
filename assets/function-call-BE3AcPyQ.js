import{D as M,E as ae,j as z,r as x,d as B,c,T as U,G as F,H as G,I as H,p as k,g as se,l as le,J as ce,F as re,n as ie,v as ue,K as de,m as fe}from"./index-B6FFb5jA.js";import{t as y,E,n as g,g as ve,V as me,W as ye,p as Y,c as D,e as Z,j as p,X as he,y as V,w as W,a as J,S as pe,Y as R,m as w,Z as Ie,I as Oe,_ as we,k as ke,M as ge,o as Ce}from"./index-qFpobu3P.js";let Se=2e3;const be=()=>++Se,_={show:Boolean,zIndex:g,overlay:y,duration:g,teleport:[String,Object],lockScroll:y,lazyRender:y,beforeClose:Function,overlayProps:Object,overlayStyle:Object,overlayClass:E,transitionAppear:Boolean,closeOnClickOverlay:y},Je=Object.keys(_);let O=0;const j="van-overflow-hidden";function Pe(e,o){const t=ve(),l="01",a="10",r=u=>{t.move(u);const m=t.deltaY.value>0?a:l,T=ye(u.target,e.value),{scrollHeight:I,offsetHeight:S,scrollTop:b}=T;let d="11";b===0?d=S>=I?"00":"01":b+S>=I&&(d="10"),d!=="11"&&t.isVertical()&&!(parseInt(d,2)&parseInt(m,2))&&Y(u,!0)},i=()=>{document.addEventListener("touchstart",t.start),document.addEventListener("touchmove",r,{passive:!1}),O||document.body.classList.add(j),O++},s=()=>{O&&(document.removeEventListener("touchstart",t.start),document.removeEventListener("touchmove",r),O--,O||document.body.classList.remove(j))},v=()=>o()&&i(),C=()=>o()&&s();me(v),M(C),ae(C),z(o,u=>{u?i():s()})}function X(e){const o=x(!1);return z(e,t=>{t&&(o.value=t)},{immediate:!0}),t=>()=>o.value?t():null}const[xe,Te]=D("overlay"),Ae={show:Boolean,zIndex:g,duration:g,className:E,lockScroll:y,lazyRender:y,customStyle:Object,teleport:[String,Object]};var ze=B({name:xe,inheritAttrs:!1,props:Ae,setup(e,{attrs:o,slots:t}){const l=x(),a=X(()=>e.show||!e.lazyRender),r=s=>{e.lockScroll&&Y(s,!0)},i=a(()=>{var s;const v=p(he(e.zIndex),e.customStyle);return V(e.duration)&&(v.animationDuration=`${e.duration}s`),G(c("div",k({ref:l,style:v,class:[Te(),e.className]},o),[(s=t.default)==null?void 0:s.call(t)]),[[H,e.show]])});return Z("touchmove",r,{target:l}),()=>{const s=c(U,{name:"van-fade",appear:!0},{default:i});return e.teleport?c(F,{to:e.teleport},{default:()=>[s]}):s}}});const Be=W(ze),Ee=p({},_,{round:Boolean,position:w("center"),closeIcon:w("cross"),closeable:Boolean,transition:String,iconPrefix:String,closeOnPopstate:Boolean,closeIconPosition:w("top-right"),destroyOnClose:Boolean,safeAreaInsetTop:Boolean,safeAreaInsetBottom:Boolean}),[De,$]=D("popup");var _e=B({name:De,inheritAttrs:!1,props:Ee,emits:["open","close","opened","closed","keydown","update:show","clickOverlay","clickCloseIcon"],setup(e,{emit:o,attrs:t,slots:l}){let a,r;const i=x(),s=x(),v=X(()=>e.show||!e.lazyRender),C=se(()=>{const n={zIndex:i.value};if(V(e.duration)){const f=e.position==="center"?"animationDuration":"transitionDuration";n[f]=`${e.duration}s`}return n}),u=()=>{a||(a=!0,i.value=e.zIndex!==void 0?+e.zIndex:be(),o("open"))},m=()=>{a&&pe(e.beforeClose,{done(){a=!1,o("close"),o("update:show",!1)}})},T=n=>{o("clickOverlay",n),e.closeOnClickOverlay&&m()},I=()=>{if(e.overlay){const n=p({show:e.show,class:e.overlayClass,zIndex:i.value,duration:e.duration,customStyle:e.overlayStyle,role:e.closeOnClickOverlay?"button":void 0,tabindex:e.closeOnClickOverlay?0:void 0},e.overlayProps);return c(Be,k(n,R(),{onClick:T}),{default:l["overlay-content"]})}},S=n=>{o("clickCloseIcon",n),m()},b=()=>{if(e.closeable)return c(Oe,{role:"button",tabindex:0,name:e.closeIcon,class:[$("close-icon",e.closeIconPosition),Ie],classPrefix:e.iconPrefix,onClick:S},null)};let d;const q=()=>{d&&clearTimeout(d),d=setTimeout(()=>{o("opened")})},Q=()=>o("closed"),ee=n=>o("keydown",n),oe=v(()=>{var n;const{destroyOnClose:f,round:A,position:P,safeAreaInsetTop:te,safeAreaInsetBottom:ne,show:N}=e;if(!(!N&&f))return G(c("div",k({ref:s,style:C.value,role:"dialog",tabindex:0,class:[$({round:A,[P]:P}),{"van-safe-area-top":te,"van-safe-area-bottom":ne}],onKeydown:ee},t,R()),[(n=l.default)==null?void 0:n.call(l),b()]),[[H,N]])}),L=()=>{const{position:n,transition:f,transitionAppear:A}=e,P=n==="center"?"van-fade":`van-popup-slide-${n}`;return c(U,{name:f||P,appear:A,onAfterEnter:q,onAfterLeave:Q},{default:oe})};return z(()=>e.show,n=>{n&&!a&&(u(),t.tabindex===0&&ie(()=>{var f;(f=s.value)==null||f.focus()})),!n&&a&&(a=!1,o("close"))}),J({popupRef:s}),Pe(s,()=>e.show&&e.lockScroll),Z("popstate",()=>{e.closeOnPopstate&&(m(),r=!1)}),le(()=>{e.show&&u()}),ce(()=>{r&&(o("update:show",!0),r=!1)}),M(()=>{e.show&&e.teleport&&(m(),r=!0)}),ue(we,()=>e.show),()=>e.teleport?c(F,{to:e.teleport},{default:()=>[I(),L()]}):c(re,null,[I(),L()])}});const Le=W(_e);function Ne(){const e=fe({show:!1}),o=a=>{e.show=a},t=a=>{p(e,a,{transitionAppear:!0}),o(!0)},l=()=>o(!1);return J({open:t,close:l,toggle:o}),{open:t,close:l,state:e,toggle:o}}function Re(e){const o=de(e),t=document.createElement("div");return document.body.appendChild(t),{instance:o.mount(t),unmount(){o.unmount(),document.body.removeChild(t)}}}const[je,$e]=D("notify"),Ke=["lockScroll","position","show","teleport","zIndex"],Me=p({},_,{type:w("danger"),color:String,message:g,position:w("top"),className:E,background:String,lockScroll:Boolean});var Ue=B({name:je,props:Me,emits:["update:show"],setup(e,{emit:o,slots:t}){const l=a=>o("update:show",a);return()=>c(Le,k({class:[$e([e.type]),e.className],style:{color:e.color,background:e.background},overlay:!1,duration:.2,"onUpdate:show":l},ke(e,Ke)),{default:()=>[t.default?t.default():e.message]})}});let K,h;const Fe=e=>Ce(e)?e:{message:e};function Ge(){({instance:h}=Re({setup(){const{state:e,toggle:o}=Ne();return()=>c(Ue,k(e,{"onUpdate:show":o}),null)}}))}const He=()=>({type:"danger",color:void 0,message:"",onClose:void 0,onClick:void 0,onOpened:void 0,duration:3e3,position:void 0,className:"",lockScroll:!1,background:void 0});let Ye=He();const Ze=()=>{h&&h.toggle(!1)};function Xe(e){if(ge)return h||Ge(),e=p({},Ye,Fe(e)),h.open(e),clearTimeout(K),e.duration>0&&(K=setTimeout(Ze,e.duration)),h}export{Le as P,_ as a,Re as m,Je as p,Xe as s,Ne as u};
