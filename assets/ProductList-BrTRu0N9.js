/* empty css              *//* empty css              *//* empty css              *//* empty css              */import{a as m,f as R,K as c,j as a,O as o,P as d,R as i,u as f,Q as I,M as u,F as T,S as U,U as F,V as E,B as D}from"./vendor-D3f-zqfy.js";import{_ as K,u as M}from"./index-BhL1k30R.js";import{u as j}from"./products-mA5VcQiw.js";import{N as q,S as z,T as O,P as Q,e as A,L as G,B as H,s as v,d as J}from"./vant-mJHwfJc2.js";const W={class:"product-list"},X={class:"search-section"},Y={class:"filter-section"},Z={class:"products-container"},ee={class:"product-grid"},se=["onClick"],te={class:"product-image"},oe=["src","alt"],ae={key:0,class:"stock-warning"},ne={class:"product-info"},ie={class:"description"},le={class:"product-footer"},re={class:"points"},ce={class:"points-bar"},de={__name:"ProductList",setup(ue){const h=I(),n=M(),g=j(),l=m(""),_=m("all"),p=m(!1),k=R(()=>{let e=[...g.products];switch(l.value&&(e=e.filter(t=>t.name.toLowerCase().includes(l.value.toLowerCase())||t.description.toLowerCase().includes(l.value.toLowerCase()))),_.value){case"low":e=e.filter(t=>t.points<=500);break;case"high":e=e.filter(t=>t.points>500);break;case"popular":e=e.slice(0,4);break}return e}),w=()=>{},C=()=>{},b=()=>{setTimeout(()=>{p.value=!1,v({type:"success",message:"重新整理完成"})},1e3)},y=e=>{h.push(`/exchange/${e}`)},V=async e=>{if(n.userInfo.points<e.points){v({type:"warning",message:"點數不足，無法兌換"});return}try{await J({title:"確認兌換",message:`確定要兌換「${e.name}」嗎？
需要 ${e.points} 點數`}),n.deductPoints(e.points)&&(n.addExchangeRecord({productName:e.name,points:e.points,type:"exchange"}),v({type:"success",message:"兌換成功！"}))}catch{}};return(e,t)=>{const L=q,S=z,r=A,P=O,x=H,N=G,B=Q;return u(),c("div",W,[a(L,{title:"商品兌換","left-arrow":"",onClickLeft:t[0]||(t[0]=s=>e.$router.back())}),o("div",X,[a(S,{modelValue:l.value,"onUpdate:modelValue":t[1]||(t[1]=s=>l.value=s),placeholder:"搜尋商品",onSearch:w},null,8,["modelValue"])]),o("div",Y,[a(P,{active:_.value,"onUpdate:active":t[2]||(t[2]=s=>_.value=s),onChange:C},{default:d(()=>[a(r,{title:"全部商品",name:"all"}),a(r,{title:"低點數",name:"low"}),a(r,{title:"高點數",name:"high"}),a(r,{title:"熱門",name:"popular"})]),_:1},8,["active"])]),o("div",Z,[a(B,{modelValue:p.value,"onUpdate:modelValue":t[3]||(t[3]=s=>p.value=s),onRefresh:b},{default:d(()=>[a(N,null,{default:d(()=>[o("div",ee,[(u(!0),c(T,null,U(k.value,s=>(u(),c("div",{key:s.id,class:"product-card",onClick:$=>y(s.id)},[o("div",te,[o("img",{src:s.image,alt:s.name},null,8,oe),s.stock<10?(u(),c("div",ae," 僅剩 "+i(s.stock)+" 件 ",1)):F("",!0)]),o("div",ne,[o("h3",null,i(s.name),1),o("p",ie,i(s.description),1),o("div",le,[o("span",re,i(s.points)+" 點",1),a(x,{type:"primary",size:"small",disabled:f(n).userInfo.points<s.points,onClick:E($=>V(s),["stop"])},{default:d(()=>[D(i(f(n).userInfo.points<s.points?"點數不足":"立即兌換"),1)]),_:2},1032,["disabled","onClick"])])])],8,se))),128))])]),_:1})]),_:1},8,["modelValue"])]),o("div",ce,[o("span",null,"我的點數："+i(f(n).userInfo.points),1)])])}}},we=K(de,[["__scopeId","data-v-a1c3af17"]]);export{we as default};
